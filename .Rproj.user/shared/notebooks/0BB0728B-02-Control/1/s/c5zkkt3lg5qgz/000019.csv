"0","schema_url <- ""https://raw.githubusercontent.com/etalab/tableschema-template/master/schema.json"""
"0","data_url <- ""https://datagistips.shinyapps.io/tableschema/some-data/data.csv"""
"0",""
"0","control_data <- function(data_url, schema_url) {"
"0","  url <- glue(""https://api.validata.etalab.studio/validate?schema={schema_url}&url={data_url}"") %>% URLencode"
"0",""
"0","  j <- jsonlite::fromJSON(url)"
"0","  errors <- j$report$tasks$errors[[1]]"
"0","  "
"0","  # If no error, return nothin"
"0","  if(length(errors) == 0) {"
"0","    return()"
"0","  }"
"0","  "
"0","  # If errors"
"0","  if(!(""fieldName"" %in% names(errors))) {"
"0","    errors <- errors %>% "
"0","        select(rowNumber, code, description, message)"
"0","    return(errors) # Later, do something with it"
"0","  } else {"
"0","      errors <- errors %>% "
"0","        select(rowNumber, fieldNumber, fieldName, code, description, message)"
"0","    return(errors)"
"0","  }"
"0","}"
"0",""
"0","errors <- control_data(data_url, schema_url)"
"0","errors"
